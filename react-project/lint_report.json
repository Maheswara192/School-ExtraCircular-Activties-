[{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\App.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\admin\\components\\AdminLayout.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\admin\\components\\AdminPrivateRoute.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\admin\\components\\Sidebar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\admin\\components\\StatusBadge.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\admin\\pages\\AdminLogin.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\admin\\pages\\Applications.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":118,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":118,"endColumn":27}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useSocket } from '../../context/SocketContext';\r\nimport { toast } from 'react-hot-toast';\r\nimport StatusBadge from '../components/StatusBadge';\r\nimport adminApi from '../utils/api';\r\nimport '../admin.css';\r\n\r\nconst Applications = () => {\r\n    const [applications, setApplications] = useState([]);\r\n    const [filteredApplications, setFilteredApplications] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [statusFilter, setStatusFilter] = useState('All');\r\n\r\n    // Edit Modal State\r\n    const [isEditModalOpen, setIsEditModalOpen] = useState(false);\r\n    const [currentApplication, setCurrentApplication] = useState(null);\r\n    const [editFormData, setEditFormData] = useState({\r\n        studentName: '',\r\n        class: '',\r\n        section: '',\r\n        rollNumber: '',\r\n        phone: '',\r\n        activity: ''\r\n    });\r\n\r\n    const openEditModal = (app) => {\r\n        setCurrentApplication(app);\r\n        setEditFormData({\r\n            studentName: app.studentName || '',\r\n            class: app.class || '',\r\n            section: app.section || '',\r\n            rollNumber: app.rollNumber || '',\r\n            phone: app.phone || '',\r\n            activity: app.activity || ''\r\n        });\r\n        setIsEditModalOpen(true);\r\n    };\r\n\r\n    const handleEditSubmit = async (e) => {\r\n        e.preventDefault();\r\n        try {\r\n            const res = await adminApi.put(`/applications/${currentApplication._id}`, editFormData);\r\n            // Update local state\r\n            setApplications(prev => prev.map(app => app._id === currentApplication._id ? res.data : app));\r\n            setIsEditModalOpen(false);\r\n            toast.success(\"Application updated successfully\");\r\n        } catch (error) {\r\n            toast.error(\"Failed to update application: \" + (error.response?.data?.message || \"Unknown error\"));\r\n        }\r\n    };\r\n\r\n    // Fetch apps\r\n    useEffect(() => {\r\n        fetchApplications();\r\n        fetchApplications();\r\n    }, []);\r\n\r\n    // Real-Time Updates\r\n    const socket = useSocket();\r\n    useEffect(() => {\r\n        if (!socket) return;\r\n\r\n        const handleNewApp = (newApp) => {\r\n            setApplications(prev => [newApp, ...prev]);\r\n            toast.success(`New application received: ${newApp.studentName}`);\r\n        };\r\n\r\n        const handleUpdateApp = (updatedApp) => {\r\n            setApplications(prev => prev.map(app => app._id === updatedApp._id ? updatedApp : app));\r\n        };\r\n\r\n        socket.on('new_application', handleNewApp);\r\n        socket.on('application_updated', handleUpdateApp);\r\n\r\n        return () => {\r\n            socket.off('new_application', handleNewApp);\r\n            socket.off('application_updated', handleUpdateApp);\r\n        };\r\n    }, [socket]);\r\n\r\n    // Filter effect\r\n    useEffect(() => {\r\n        if (statusFilter === 'All') {\r\n            setFilteredApplications(applications);\r\n        } else {\r\n            setFilteredApplications(applications.filter(app => app.status && app.status.toLowerCase() === statusFilter.toLowerCase()));\r\n        }\r\n    }, [statusFilter, applications]);\r\n\r\n    const fetchApplications = async () => {\r\n        try {\r\n            const res = await adminApi.get('/applications');\r\n            const data = Array.isArray(res.data) ? res.data : (res.data.data || []);\r\n            setApplications(data);\r\n            setFilteredApplications(data);\r\n        } catch (error) {\r\n            console.error(\"Failed to fetch applications\", error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleStatusUpdate = async (id, newStatus) => {\r\n        try {\r\n            await adminApi.put(`/applications/${id}`, { status: newStatus });\r\n            setApplications(prev => prev.map(app => app._id === id ? { ...app, status: newStatus } : app));\r\n        } catch (error) {\r\n            toast.error(\"Failed to update status: \" + (error.response?.data?.message || \"Unknown error\"));\r\n        }\r\n    };\r\n\r\n    const handleDelete = async (id) => {\r\n        if (window.confirm(\"Are you sure you want to delete this application?\")) {\r\n            try {\r\n                await adminApi.delete(`/applications/${id}`);\r\n                setApplications(prev => prev.filter(app => app._id !== id));\r\n            } catch (error) {\r\n                toast.error(\"Failed to delete application\");\r\n            }\r\n        }\r\n    };\r\n\r\n    const downloadCSV = () => {\r\n        const headers = [\"ID,Student Name,Class,Roll Number,Phone,Activity,Status,Date\"];\r\n        const rows = filteredApplications.map(app => [\r\n            app._id,\r\n            `\"${(app.studentName || '').replace(/\"/g, '\"\"')}\"`,\r\n            app.class,\r\n            app.rollNumber,\r\n            app.phone,\r\n            `\"${(app.activity || '').replace(/\"/g, '\"\"')}\"`,\r\n            app.status,\r\n            new Date(app.createdAt).toLocaleDateString()\r\n        ].join(','));\r\n\r\n        const csvContent = headers.concat(rows).join('\\n');\r\n        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n        const url = URL.createObjectURL(blob);\r\n        const link = document.createElement('a');\r\n        link.setAttribute('href', url);\r\n        link.setAttribute('download', `applications_export_${new Date().toISOString().slice(0, 10)}.csv`);\r\n        link.style.visibility = 'hidden';\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '2rem' }}>\r\n                <h1>Student Applications</h1>\r\n                <div style={{ display: 'flex', gap: '1rem' }}>\r\n                    <button className=\"btn\" onClick={downloadCSV} style={{ backgroundColor: '#6366f1', color: 'white' }}>\r\n                        Export CSV\r\n                    </button>\r\n                    <select\r\n                        className=\"form-select\"\r\n                        style={{ width: '200px' }}\r\n                        value={statusFilter}\r\n                        onChange={(e) => setStatusFilter(e.target.value)}\r\n                    >\r\n                        <option value=\"All\">All Statuses</option>\r\n                        <option value=\"pending\">Pending</option>\r\n                        <option value=\"accepted\">Accepted</option>\r\n                        <option value=\"rejected\">Rejected</option>\r\n                    </select>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"table-container\">\r\n                <table className=\"admin-table\">\r\n                    <thead>\r\n                        <tr>\r\n                            <th>Student Name</th>\r\n                            <th>Activity</th>\r\n                            <th>Review Status</th>\r\n                            <th>Actions</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {loading ? (\r\n                            <tr><td colSpan=\"4\" style={{ textAlign: 'center' }}>Loading...</td></tr>\r\n                        ) : filteredApplications.map(app => (\r\n                            <tr key={app._id}>\r\n                                <td>\r\n                                    {app.studentName}\r\n                                    <div style={{ fontSize: '0.75rem', color: 'var(--admin-text-light)' }}>\r\n                                        {app.class} - {app.rollNumber}\r\n                                    </div>\r\n                                </td>\r\n                                <td>\r\n                                    {app.activity}\r\n                                    {app.eventId && app.eventId.category && (\r\n                                        <div style={{ fontSize: '0.75rem', color: 'var(--admin-text-light)' }}>\r\n                                            {app.eventId.category}\r\n                                        </div>\r\n                                    )}\r\n                                </td>\r\n                                <td><StatusBadge status={app.status} /></td>\r\n                                <td>\r\n                                    <div style={{ display: 'flex', gap: '5px' }}>\r\n                                        <button\r\n                                            className=\"btn btn-sm\"\r\n                                            style={{ backgroundColor: '#3b82f6', color: 'white' }}\r\n                                            onClick={() => openEditModal(app)}\r\n                                        >\r\n                                            Edit\r\n                                        </button>\r\n                                        <button\r\n                                            className=\"btn btn-sm\"\r\n                                            style={{ backgroundColor: '#10b981', color: 'white' }}\r\n                                            onClick={() => handleStatusUpdate(app._id, 'Accepted')}\r\n                                            disabled={app.status === 'Accepted'}\r\n                                        >\r\n                                            Accept\r\n                                        </button>\r\n                                        <button\r\n                                            className=\"btn btn-sm\"\r\n                                            style={{ backgroundColor: '#ef4444', color: 'white' }}\r\n                                            onClick={() => handleStatusUpdate(app._id, 'Rejected')}\r\n                                            disabled={app.status === 'Rejected'}\r\n                                        >\r\n                                            Reject\r\n                                        </button>\r\n                                        <button className=\"btn btn-sm btn-danger\" onClick={() => handleDelete(app._id)}>Delete</button>\r\n                                    </div>\r\n                                </td>\r\n                            </tr>\r\n                        ))}\r\n                        {!loading && filteredApplications.length === 0 && (\r\n                            <tr>\r\n                                <td colSpan=\"4\" style={{ textAlign: 'center', color: 'var(--admin-text-light)' }}>No applications found.</td>\r\n                            </tr>\r\n                        )}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n\r\n            {/* Edit Application Modal */}\r\n            {isEditModalOpen && (\r\n                <div className=\"modal-overlay\">\r\n                    <div className=\"modal-content\">\r\n                        <div className=\"modal-header\">\r\n                            <span>Edit Application</span>\r\n                            <button onClick={() => setIsEditModalOpen(false)} style={{ background: 'none', border: 'none', cursor: 'pointer', fontSize: '1.5rem' }}>&times;</button>\r\n                        </div>\r\n                        <form onSubmit={handleEditSubmit}>\r\n                            <div className=\"form-group\">\r\n                                <label className=\"form-label\">Student Name</label>\r\n                                <input\r\n                                    className=\"form-input\"\r\n                                    value={editFormData.studentName}\r\n                                    onChange={(e) => setEditFormData({ ...editFormData, studentName: e.target.value })}\r\n                                    required\r\n                                />\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label className=\"form-label\">Class</label>\r\n                                <input\r\n                                    className=\"form-input\"\r\n                                    value={editFormData.class}\r\n                                    onChange={(e) => setEditFormData({ ...editFormData, class: e.target.value })}\r\n                                    required\r\n                                />\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label className=\"form-label\">Section</label>\r\n                                <input\r\n                                    className=\"form-input\"\r\n                                    value={editFormData.section}\r\n                                    onChange={(e) => setEditFormData({ ...editFormData, section: e.target.value })}\r\n                                    required\r\n                                />\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label className=\"form-label\">Roll Number</label>\r\n                                <input\r\n                                    className=\"form-input\"\r\n                                    value={editFormData.rollNumber}\r\n                                    onChange={(e) => setEditFormData({ ...editFormData, rollNumber: e.target.value })}\r\n                                    required\r\n                                />\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label className=\"form-label\">Phone</label>\r\n                                <input\r\n                                    className=\"form-input\"\r\n                                    value={editFormData.phone}\r\n                                    onChange={(e) => setEditFormData({ ...editFormData, phone: e.target.value })}\r\n                                    required\r\n                                />\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label className=\"form-label\">Activity</label>\r\n                                <input\r\n                                    className=\"form-input\"\r\n                                    value={editFormData.activity}\r\n                                    onChange={(e) => setEditFormData({ ...editFormData, activity: e.target.value })}\r\n                                    required\r\n                                />\r\n                                <small style={{ color: '#64748b' }}>Note: Changing activity does not check capacity rules.</small>\r\n                            </div>\r\n                            <div className=\"modal-actions\">\r\n                                <button type=\"button\" className=\"btn\" onClick={() => setIsEditModalOpen(false)}>Cancel</button>\r\n                                <button type=\"submit\" className=\"btn btn-primary\">Save Changes</button>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Applications;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\admin\\pages\\Dashboard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\admin\\pages\\Events.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\admin\\pages\\ForgotCredentials.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\admin\\pages\\ParticipationAnalytics.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\admin\\pages\\PerformanceManager.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":63,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":63,"endColumn":27}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport adminApi from '../utils/api';\r\nimport '../admin.css';\r\n\r\nconst PerformanceManager = () => {\r\n    const [events, setEvents] = useState([]);\r\n    const [selectedEventId, setSelectedEventId] = useState('');\r\n    const [selectedEvent, setSelectedEvent] = useState(null);\r\n    const [students, setStudents] = useState([]);\r\n    const [scores, setScores] = useState({}); // { rollNumber: score }\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    // Fetch Events on Mount\r\n    useEffect(() => {\r\n        const fetchEvents = async () => {\r\n            try {\r\n                const res = await adminApi.get('/events?limit=100');\r\n                const list = Array.isArray(res.data) ? res.data : (res.data.data || []);\r\n                setEvents(list);\r\n            } catch (err) {\r\n                console.error(\"Failed to load events\", err);\r\n            }\r\n        };\r\n        fetchEvents();\r\n    }, []);\r\n\r\n    // Fetch Participants when Event Selected\r\n    useEffect(() => {\r\n        if (!selectedEventId) {\r\n            setStudents([]);\r\n            return;\r\n        }\r\n\r\n        const fetchParticipants = async () => {\r\n            setLoading(true);\r\n            try {\r\n                // 1. Get Event Details to know Metric Type\r\n                const eventRes = await adminApi.get(`/events/${selectedEventId}`);\r\n                setSelectedEvent(eventRes.data);\r\n\r\n                // 2. Get Accepted Applications\r\n                const appsRes = await adminApi.get('/applications');\r\n                const allApps = Array.isArray(appsRes.data) ? appsRes.data : (appsRes.data.data || []);\r\n\r\n                // Filter only 'Accepted' for this event\r\n                const participants = allApps.filter(app =>\r\n                    (app.eventId._id === selectedEventId || app.eventId === selectedEventId) &&\r\n                    app.status === 'Accepted'\r\n                );\r\n\r\n                setStudents(participants);\r\n\r\n                // 3. Load Existing Scores (Leaderboard) for pre-filling\r\n                try {\r\n                    const perfRes = await adminApi.get(`/performance/leaderboard?eventId=${selectedEventId}&level=School`);\r\n                    const existingScores = {};\r\n                    if (perfRes.data && Array.isArray(perfRes.data)) {\r\n                        perfRes.data.forEach(p => {\r\n                            existingScores[p.rollNumber] = p.score;\r\n                        });\r\n                    }\r\n                    setScores(existingScores);\r\n                } catch (e) {\r\n                    console.warn(\"No existing scores loaded\");\r\n                }\r\n\r\n            } catch (err) {\r\n                console.error(err);\r\n                alert(\"Failed to load participants\");\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchParticipants();\r\n    }, [selectedEventId]);\r\n\r\n    const handleScoreChange = (roll, val) => {\r\n        setScores(prev => ({ ...prev, [roll]: val }));\r\n    };\r\n\r\n    const saveScore = async (student) => {\r\n        const scoreVal = scores[student.rollNumber];\r\n        if (scoreVal === undefined || scoreVal === '') {\r\n            alert(\"Please enter a score\");\r\n            return;\r\n        }\r\n\r\n        try {\r\n            await adminApi.post('/performance', {\r\n                eventId: selectedEventId,\r\n                studentName: student.studentName,\r\n                rollNumber: student.rollNumber,\r\n                class: student.class,\r\n                score: Number(scoreVal),\r\n                level: 'School' // Defaulting to School Level entry for now\r\n            });\r\n            alert(`Score saved for ${student.studentName}!`);\r\n        } catch (err) {\r\n            alert(\"Failed to save score\");\r\n            console.error(err);\r\n        }\r\n    };\r\n\r\n    const handlePromote = async () => {\r\n        if (!window.confirm(\"Promote Top 5 Students to Zonal Level?\")) return;\r\n        try {\r\n            const res = await adminApi.post('/performance/promote', {\r\n                eventId: selectedEventId,\r\n                currentLevel: 'School',\r\n                nextLevel: 'Zonal',\r\n                limit: 5\r\n            });\r\n            alert(`Promotion Complete! Promoted: ${res.data.stats.promoted}`);\r\n        } catch (err) {\r\n            alert(\"Promotion Failed: \" + (err.response?.data?.message || err.message));\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"fade-in\">\r\n            <h1>üèÜ Performance Management</h1>\r\n            <p className=\"description\" style={{ marginBottom: '2rem' }}>Enter scores and manage promotions for events.</p>\r\n\r\n            <div className=\"card\" style={{ marginBottom: '2rem' }}>\r\n                <label className=\"form-label\">Select Event to Manage</label>\r\n                <select\r\n                    className=\"form-control\"\r\n                    value={selectedEventId}\r\n                    onChange={(e) => setSelectedEventId(e.target.value)}\r\n                >\r\n                    <option value=\"\">-- Choose Event --</option>\r\n                    {events.map(ev => (\r\n                        <option key={ev._id} value={ev._id}>{ev.eventName} ({ev.category})</option>\r\n                    ))}\r\n                </select>\r\n            </div>\r\n\r\n            {selectedEventId && (\r\n                <div className=\"card\">\r\n                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>\r\n                        <h3>Participants ({students.length})</h3>\r\n                        {students.length > 0 && (\r\n                            <button className=\"btn btn-primary\" onClick={handlePromote} style={{ backgroundColor: '#8b5cf6' }}>\r\n                                üöÄ Promote Top 5 to Zonal\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n\r\n                    {loading ? (\r\n                        <p>Loading participants...</p>\r\n                    ) : students.length === 0 ? (\r\n                        <p className=\"text-muted\">No accepted participants found for this event.</p>\r\n                    ) : (\r\n                        <table className=\"admin-table\">\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>Student</th>\r\n                                    <th>Class</th>\r\n                                    <th>Score / Metric ({selectedEvent?.metricConfig?.unit || 'pts'})</th>\r\n                                    <th>Action</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                {students.map(student => (\r\n                                    <tr key={student._id}>\r\n                                        <td>{student.studentName} <br /><small>{student.rollNumber}</small></td>\r\n                                        <td>{student.class}</td>\r\n                                        <td>\r\n                                            <input\r\n                                                type=\"number\"\r\n                                                className=\"form-control\"\r\n                                                style={{ width: '120px' }}\r\n                                                placeholder={selectedEvent?.metricConfig?.metricLabel || 'Score'}\r\n                                                value={scores[student.rollNumber] || ''}\r\n                                                onChange={(e) => handleScoreChange(student.rollNumber, e.target.value)}\r\n                                            />\r\n                                        </td>\r\n                                        <td>\r\n                                            <button className=\"btn btn-sm\" onClick={() => saveScore(student)}>\r\n                                                Save\r\n                                            </button>\r\n                                        </td>\r\n                                    </tr>\r\n                                ))}\r\n                            </tbody>\r\n                        </table>\r\n                    )}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default PerformanceManager;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\admin\\utils\\api.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\admin\\utils\\auth.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\api.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\components\\ActivityCard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\components\\ApplicationForm.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\components\\Footer.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\components\\Navbar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\components\\PublicLayout.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\context\\AuthContext.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useNavigate' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"useNavigate"},"fix":{"range":[82,129],"text":""},"desc":"Remove unused variable 'useNavigate'."}]},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":68,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":68,"endColumn":21}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { createContext, useState, useEffect, useContext } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport adminApi from '../admin/utils/api';\r\n\r\nconst AuthContext = createContext(null);\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n    const [user, setUser] = useState(null);\r\n    const [token, setToken] = useState(localStorage.getItem('adminToken'));\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        // Initialize state from local storage on load\r\n        const storedUser = localStorage.getItem('adminUser');\r\n        const storedToken = localStorage.getItem('adminToken');\r\n\r\n        if (storedToken && storedUser) {\r\n            setUser(JSON.parse(storedUser));\r\n            setToken(storedToken);\r\n        }\r\n        setLoading(false);\r\n    }, []);\r\n\r\n    const login = async (email, password) => {\r\n        try {\r\n            const response = await adminApi.post('/auth/login', { email, password });\r\n            const { token, role, ...userData } = response.data;\r\n\r\n            if (role !== 'admin') {\r\n                throw new Error('Unauthorized Access: Admins only.');\r\n            }\r\n\r\n            const adminUser = { ...userData, role };\r\n\r\n            // Storage\r\n            localStorage.setItem('adminToken', token);\r\n            localStorage.setItem('adminUser', JSON.stringify(adminUser));\r\n\r\n            // State\r\n            setToken(token);\r\n            setUser(adminUser);\r\n\r\n            return adminUser;\r\n        } catch (error) {\r\n            throw error.response?.data?.message || 'Login failed';\r\n        }\r\n    };\r\n\r\n    const logout = () => {\r\n        localStorage.removeItem('adminToken');\r\n        localStorage.removeItem('adminUser');\r\n        setToken(null);\r\n        setUser(null);\r\n        // Note: Navigation might need to be handled by the component calling logout or via useEffect in App\r\n    };\r\n\r\n    const isAuthenticated = !!token && user?.role === 'admin';\r\n    console.log(\"AuthContext: isAuthenticated?\", isAuthenticated, \"Token:\", !!token, \"Role:\", user?.role);\r\n\r\n    return (\r\n        <AuthContext.Provider value={{ user, token, loading, login, logout, isAuthenticated }}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useAuth = () => useContext(AuthContext);\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\context\\SocketContext.jsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  24 |         });\n  25 |\n> 26 |         setSocket(newSocket);\n     |         ^^^^^^^^^ Avoid calling setState() directly within an effect\n  27 |\n  28 |         return () => {\n  29 |             newSocket.close();","line":26,"column":9,"nodeType":null,"endLine":26,"endColumn":18},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":40,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":40,"endColumn":23}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { createContext, useContext, useEffect, useState } from 'react';\r\nimport io from 'socket.io-client';\r\n\r\nconst SocketContext = createContext(null);\r\n\r\nexport const SocketProvider = ({ children }) => {\r\n    const [socket, setSocket] = useState(null);\r\n\r\n    useEffect(() => {\r\n        // Ensure this matches your backend URL/Port\r\n        const newSocket = io('http://localhost:5000', {\r\n            withCredentials: true,\r\n            transports: ['websocket', 'polling'], // Prioritize websocket\r\n            autoConnect: true,\r\n        });\r\n\r\n        newSocket.on('connect', () => {\r\n            console.log('Socket Connected:', newSocket.id);\r\n        });\r\n\r\n        newSocket.on('disconnect', () => {\r\n            console.log('Socket Disconnected');\r\n        });\r\n\r\n        setSocket(newSocket);\r\n\r\n        return () => {\r\n            newSocket.close();\r\n        };\r\n    }, []);\r\n\r\n    return (\r\n        <SocketContext.Provider value={socket}>\r\n            {children}\r\n        </SocketContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useSocket = () => useContext(SocketContext);\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\main.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\pages\\Activities.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\pages\\Apply.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\pages\\Home.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\pages\\Leaderboard.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchLeaderboard'. Either include it or remove the dependency array.","line":49,"column":8,"nodeType":"ArrayExpression","endLine":49,"endColumn":30,"suggestions":[{"desc":"Update the dependencies array to be: [selectedEvent, level, fetchLeaderboard]","fix":{"range":[1694,1716],"text":"[selectedEvent, level, fetchLeaderboard]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchLeaderboard'. Either include it or remove the dependency array.","line":68,"column":8,"nodeType":"ArrayExpression","endLine":68,"endColumn":38,"suggestions":[{"desc":"Update the dependencies array to be: [socket, selectedEvent, level, fetchLeaderboard]","fix":{"range":[2301,2331],"text":"[socket, selectedEvent, level, fetchLeaderboard]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\n// Navbar removed\r\nimport api from '../api';\r\nimport { useSocket } from '../context/SocketContext';\r\nimport { FaMedal, FaTrophy, FaSearch, FaFilter } from 'react-icons/fa';\r\n\r\nconst Leaderboard = () => {\r\n    const socket = useSocket();\r\n    const [events, setEvents] = useState([]);\r\n    const [selectedEvent, setSelectedEvent] = useState('');\r\n    const [level, setLevel] = useState('Class'); // Class, School, Zonal\r\n    const [leaderboard, setLeaderboard] = useState([]);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    // Fetch Events for Dropdown\r\n    useEffect(() => {\r\n        const fetchEvents = async () => {\r\n            try {\r\n                const { data } = await api.get('/events?limit=100');\r\n                const list = Array.isArray(data) ? data : (data.data || []);\r\n                setEvents(list);\r\n                if (list.length > 0) setSelectedEvent(list[0]._id);\r\n            } catch (err) {\r\n                console.error(err);\r\n            }\r\n        };\r\n        fetchEvents();\r\n    }, []);\r\n\r\n    // Fetch Leaderboard Data\r\n    const fetchLeaderboard = async () => {\r\n        if (!selectedEvent) return;\r\n        setLoading(true);\r\n        try {\r\n            const { data } = await api.get(`/performance/leaderboard`, {\r\n                params: { eventId: selectedEvent, level }\r\n            });\r\n            setLeaderboard(data);\r\n        } catch (err) {\r\n            console.error(\"Failed to load leaderboard\", err);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    // Initial Fetch & Dependency on Selection\r\n    useEffect(() => {\r\n        fetchLeaderboard();\r\n    }, [selectedEvent, level]);\r\n\r\n    // Real-time Updates via Socket.IO\r\n    useEffect(() => {\r\n        if (!socket) return;\r\n\r\n        const handleUpdate = (data) => {\r\n            // Only refresh if the update is for the current view\r\n            if (data.eventId === selectedEvent && data.level === level) {\r\n                console.log(\"Real-time Leaderboard Update Received!\");\r\n                fetchLeaderboard();\r\n            }\r\n        };\r\n\r\n        socket.on('leaderboard_update', handleUpdate);\r\n\r\n        return () => {\r\n            socket.off('leaderboard_update', handleUpdate);\r\n        };\r\n    }, [socket, selectedEvent, level]);\r\n\r\n    const getMedal = (rank) => {\r\n        switch (rank) {\r\n            case 0: return <FaMedal color=\"#FFD700\" size={24} title=\"Gold\" />; // Gold\r\n            case 1: return <FaMedal color=\"#C0C0C0\" size={24} title=\"Silver\" />; // Silver\r\n            case 2: return <FaMedal color=\"#CD7F32\" size={24} title=\"Bronze\" />; // Bronze\r\n            default: return <span style={{ fontWeight: 'bold', marginLeft: '0.4rem' }}>#{rank + 1}</span>;\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            {/* Navbar handled by Layout */}\r\n            <div className=\"container section-padding\">\r\n                <div style={{ textAlign: 'center', marginBottom: '3rem' }}>\r\n                    <h1 style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '1rem', marginBottom: '1rem' }}>\r\n                        <FaTrophy color=\"#F59E0B\" /> Live Leaderboard\r\n                    </h1>\r\n                    <p className=\"text-muted\">Track top performers across Class, School, and Zonal levels.</p>\r\n                </div>\r\n\r\n                {/* Controls */}\r\n                <div className=\"card fade-in\" style={{ marginBottom: '2rem', display: 'flex', gap: '1rem', alignItems: 'center', flexWrap: 'wrap' }}>\r\n                    <div style={{ flex: 1, minWidth: '200px' }}>\r\n                        <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: 'bold' }}>Select Event</label>\r\n                        <div style={{ position: 'relative' }}>\r\n                            <FaSearch style={{ position: 'absolute', left: '10px', top: '12px', color: '#94a3b8' }} />\r\n                            <select\r\n                                className=\"form-control\"\r\n                                style={{ paddingLeft: '2.5rem' }}\r\n                                value={selectedEvent}\r\n                                onChange={(e) => setSelectedEvent(e.target.value)}\r\n                            >\r\n                                <option value=\"\">Select Event...</option>\r\n                                {events.map(ev => (\r\n                                    <option key={ev._id} value={ev._id}>{ev.eventName} ({ev.category})</option>\r\n                                ))}\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div style={{ flex: 1, minWidth: '200px' }}>\r\n                        <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: 'bold' }}>Select Level</label>\r\n                        <div style={{ position: 'relative' }}>\r\n                            <FaFilter style={{ position: 'absolute', left: '10px', top: '12px', color: '#94a3b8' }} />\r\n                            <select\r\n                                className=\"form-control\"\r\n                                style={{ paddingLeft: '2.5rem' }}\r\n                                value={level}\r\n                                onChange={(e) => setLevel(e.target.value)}\r\n                            >\r\n                                <option value=\"Class\">Class Level</option>\r\n                                <option value=\"School\">School Level</option>\r\n                                <option value=\"Zonal\">Zonal Level</option>\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Rankings */}\r\n                <div className=\"card fade-in\">\r\n                    {loading ? (\r\n                        <div className=\"text-center\">Loading rankings...</div>\r\n                    ) : leaderboard.length === 0 ? (\r\n                        <div className=\"text-center text-muted\" style={{ padding: '2rem' }}>\r\n                            No performance records found for this event/level.\r\n                        </div>\r\n                    ) : (\r\n                        <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n                            <thead>\r\n                                <tr style={{ borderBottom: '2px solid #e2e8f0', textAlign: 'left' }}>\r\n                                    <th style={{ padding: '1rem' }}>Rank</th>\r\n                                    <th style={{ padding: '1rem' }}>Student</th>\r\n                                    <th style={{ padding: '1rem' }}>Class</th>\r\n                                    <th style={{ padding: '1rem' }}>Score/Metric</th>\r\n                                    <th style={{ padding: '1rem' }}>Status</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                {leaderboard.map((entry, index) => (\r\n                                    <tr key={entry._id} style={{ borderBottom: '1px solid #f1f5f9' }}>\r\n                                        <td style={{ padding: '1rem', display: 'flex', alignItems: 'center' }}>\r\n                                            {getMedal(index)}\r\n                                        </td>\r\n                                        <td style={{ padding: '1rem', fontWeight: '600' }}>\r\n                                            {entry.studentName} <span className=\"text-muted\" style={{ fontWeight: 'normal', fontSize: '0.9rem' }}>({entry.rollNumber})</span>\r\n                                        </td>\r\n                                        <td style={{ padding: '1rem' }}>{entry.class}</td>\r\n                                        <td style={{ padding: '1rem', fontWeight: 'bold', color: 'var(--primary)' }}>\r\n                                            {entry.score} <span style={{ fontSize: '0.8rem', fontWeight: 'normal' }}>{entry.metricType}</span>\r\n                                        </td>\r\n                                        <td style={{ padding: '1rem' }}>\r\n                                            <span className={`badge badge-${entry.status?.toLowerCase() || 'pending'}`}>\r\n                                                {entry.status}\r\n                                            </span>\r\n                                        </td>\r\n                                    </tr>\r\n                                ))}\r\n                            </tbody>\r\n                        </table>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default Leaderboard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\pages\\NotFound.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\src\\utils\\localStorage.bak.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahis\\OneDrive\\Desktop\\Extra circular activities\\School-ExtraCircular-Activties-\\react-project\\vite.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]